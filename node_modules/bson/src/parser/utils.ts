const map = new WeakMap<object, string>();

const TYPES = {
  ArrayBuffer: '[object ArrayBuffer]',
  SharedArrayBuffer: '[object SharedArrayBuffer]',
  Uint8Array: '[object Uint8Array]',
  BigInt64Array: '[object BigInt64Array]',
  BigUint64Array: '[object BigUint64Array]',
  RegE***REMOVED***p: '[object RegE***REMOVED***p]',
  Map: '[object Map]',
  Date: '[object Date]'
};

/**
 * Retrieves the prototype.toString() of a value.
 * If the value is an object, it will cache the result in a WeakMap for future use.
 */
function getPrototypeString(value: unknown): string {
  let str = map.get(value as object);

  if (!str) {
    str = Object.prototype.toString.call(value);
    if (value !== null && typeof value === 'object') {
      map.set(value, str);
    }
  }
  return str;
}

e***REMOVED***port function isAnyArrayBuffer(value: unknown): value is ArrayBuffer {
  const type = getPrototypeString(value);
  return type === TYPES.ArrayBuffer || type === TYPES.SharedArrayBuffer;
}

e***REMOVED***port function isUint8Array(value: unknown): value is Uint8Array {
  const type = getPrototypeString(value);
  return type === TYPES.Uint8Array;
}

e***REMOVED***port function isBigInt64Array(value: unknown): value is BigInt64Array {
  const type = getPrototypeString(value);
  return type === TYPES.BigInt64Array;
}

e***REMOVED***port function isBigUInt64Array(value: unknown): value is BigUint64Array {
  const type = getPrototypeString(value);
  return type === TYPES.BigUint64Array;
}

e***REMOVED***port function isRegE***REMOVED***p(d: unknown): d is RegE***REMOVED***p {
  const type = getPrototypeString(d);
  return type === TYPES.RegE***REMOVED***p;
}

e***REMOVED***port function isMap(d: unknown): d is Map<unknown, unknown> {
  const type = getPrototypeString(d);
  return type === TYPES.Map;
}

e***REMOVED***port function isDate(d: unknown): d is Date {
  const type = getPrototypeString(d);
  return type === TYPES.Date;
}

e***REMOVED***port type InspectFn = (***REMOVED***: unknown, options?: unknown) => string;
e***REMOVED***port function defaultInspect(***REMOVED***: unknown, _options?: unknown): string {
  return JSON.stringify(***REMOVED***, (k: string, v: unknown) => {
    if (typeof v === 'bigint') {
      return { $numberLong: `${v}` };
    } else if (isMap(v)) {
      return Object.fromEntries(v);
    }
    return v;
  });
}

/** @internal */
type StylizeFunction = (***REMOVED***: string, style: string) => string;
/** @internal */
e***REMOVED***port function getStylizeFunction(options?: unknown): StylizeFunction | undefined {
  const stylizeE***REMOVED***ists =
    options != null &&
    typeof options === 'object' &&
    'stylize' in options &&
    typeof options.stylize === 'function';

  if (stylizeE***REMOVED***ists) {
    return options.stylize as StylizeFunction;
  }
}
