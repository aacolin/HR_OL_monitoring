/**
 * Usage: node test.js
 */

var mime = require('../mime');
var assert = require('assert');
var path = require('path');

//
// Test mime lookups
//

assert.equal('te***REMOVED***t/plain', mime.lookup('te***REMOVED***t.t***REMOVED***t'));     // normal file
assert.equal('te***REMOVED***t/plain', mime.lookup('TEXT.TXT'));     // uppercase
assert.equal('te***REMOVED***t/plain', mime.lookup('dir/te***REMOVED***t.t***REMOVED***t')); // dir + file
assert.equal('te***REMOVED***t/plain', mime.lookup('.te***REMOVED***t.t***REMOVED***t'));    // hidden file
assert.equal('te***REMOVED***t/plain', mime.lookup('.t***REMOVED***t'));         // nameless
assert.equal('te***REMOVED***t/plain', mime.lookup('t***REMOVED***t'));          // e***REMOVED***tension-only
assert.equal('te***REMOVED***t/plain', mime.lookup('/t***REMOVED***t'));         // e***REMOVED***tension-less ()
assert.equal('te***REMOVED***t/plain', mime.lookup('\\t***REMOVED***t'));        // Windows, e***REMOVED***tension-less
assert.equal('application/octet-stream', mime.lookup('te***REMOVED***t.nope')); // unrecognized
assert.equal('fallback', mime.lookup('te***REMOVED***t.fallback', 'fallback')); // alternate default

//
// Test e***REMOVED***tensions
//

assert.equal('t***REMOVED***t', mime.e***REMOVED***tension(mime.types.te***REMOVED***t));
assert.equal('html', mime.e***REMOVED***tension(mime.types.htm));
assert.equal('bin', mime.e***REMOVED***tension('application/octet-stream'));
assert.equal('bin', mime.e***REMOVED***tension('application/octet-stream '));
assert.equal('html', mime.e***REMOVED***tension(' te***REMOVED***t/html; charset=UTF-8'));
assert.equal('html', mime.e***REMOVED***tension('te***REMOVED***t/html; charset=UTF-8 '));
assert.equal('html', mime.e***REMOVED***tension('te***REMOVED***t/html; charset=UTF-8'));
assert.equal('html', mime.e***REMOVED***tension('te***REMOVED***t/html ; charset=UTF-8'));
assert.equal('html', mime.e***REMOVED***tension('te***REMOVED***t/html;charset=UTF-8'));
assert.equal('html', mime.e***REMOVED***tension('te***REMOVED***t/Html;charset=UTF-8'));
assert.equal(undefined, mime.e***REMOVED***tension('unrecognized'));

//
// Test node.types lookups
//

assert.equal('font/woff', mime.lookup('file.woff'));
assert.equal('application/octet-stream', mime.lookup('file.buffer'));
// TODO: Uncomment once #157 is resolved
// assert.equal('audio/mp4', mime.lookup('file.m4a'));
assert.equal('font/otf', mime.lookup('file.otf'));

//
// Test charsets
//

assert.equal('UTF-8', mime.charsets.lookup('te***REMOVED***t/plain'));
assert.equal('UTF-8', mime.charsets.lookup(mime.types.js));
assert.equal('UTF-8', mime.charsets.lookup(mime.types.json));
assert.equal(undefined, mime.charsets.lookup(mime.types.bin));
assert.equal('fallback', mime.charsets.lookup('application/octet-stream', 'fallback'));

console.log('\nAll tests passed');
