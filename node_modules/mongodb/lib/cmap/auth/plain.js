"use strict";
Object.defineProperty(e***REMOVED***ports, "__esModule", { value: true });
e***REMOVED***ports.Plain = void 0;
const bson_1 = require("../../bson");
const error_1 = require("../../error");
const utils_1 = require("../../utils");
const auth_provider_1 = require("./auth_provider");
class Plain e***REMOVED***tends auth_provider_1.AuthProvider {
    async auth(authConte***REMOVED***t) {
        const { connection, credentials } = authConte***REMOVED***t;
        if (!credentials) {
            throw new error_1.MongoMissingCredentialsError('AuthConte***REMOVED***t must provide credentials.');
        }
        const { username, password } = credentials;
        const payload = new bson_1.Binary(Buffer.from(`\***REMOVED***00${username}\***REMOVED***00${password}`));
        const command = {
            saslStart: 1,
            mechanism: 'PLAIN',
            payload: payload,
            autoAuthorize: 1
        };
        await connection.command((0, utils_1.ns)('$e***REMOVED***ternal.$cmd'), command, undefined);
    }
}
e***REMOVED***ports.Plain = Plain;
//# sourceMappingURL=plain.js.map