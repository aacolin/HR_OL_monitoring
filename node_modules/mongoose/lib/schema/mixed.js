/*!
 * Module dependencies.
 */

'use strict';

const SchemaType = require('../schemaType');
const symbols = require('./symbols');
const isObject = require('../helpers/isObject');
const utils = require('../utils');

/**
 * Mi***REMOVED***ed SchemaType constructor.
 *
 * @param {String} path
 * @param {Object} options
 * @inherits SchemaType
 * @api public
 */

function SchemaMi***REMOVED***ed(path, options) {
  if (options && options.default) {
    const def = options.default;
    if (Array.isArray(def) && def.length === 0) {
      // make sure empty array defaults are handled
      options.default = Array;
    } else if (!options.shared && isObject(def) && Object.keys(def).length === 0) {
      // prevent odd "shared" objects between documents
      options.default = function() {
        return {};
      };
    }
  }

  SchemaType.call(this, path, options, 'Mi***REMOVED***ed');

  this[symbols.schemaMi***REMOVED***edSymbol] = true;
}

/**
 * This schema type's name, to defend against minifiers that mangle
 * function names.
 *
 * @api public
 */
SchemaMi***REMOVED***ed.schemaName = 'Mi***REMOVED***ed';

SchemaMi***REMOVED***ed.defaultOptions = {};

/*!
 * Inherits from SchemaType.
 */
SchemaMi***REMOVED***ed.prototype = Object.create(SchemaType.prototype);
SchemaMi***REMOVED***ed.prototype.constructor = SchemaMi***REMOVED***ed;

/**
 * Attaches a getter for all Mi***REMOVED***ed paths.
 *
 * #### E***REMOVED***ample:
 *
 *     // Hide the 'hidden' path
 *     mongoose.Schema.Mi***REMOVED***ed.get(v => Object.assign({}, v, { hidden: null }));
 *
 *     const Model = mongoose.model('Test', new Schema({ test: {} }));
 *     new Model({ test: { hidden: 'Secret!' } }).test.hidden; // null
 *
 * @param {Function} getter
 * @return {this}
 * @function get
 * @static
 * @api public
 */

SchemaMi***REMOVED***ed.get = SchemaType.get;

/**
 * Sets a default option for all Mi***REMOVED***ed instances.
 *
 * #### E***REMOVED***ample:
 *
 *     // Make all mi***REMOVED***ed instances have `required` of true by default.
 *     mongoose.Schema.Mi***REMOVED***ed.set('required', true);
 *
 *     const User = mongoose.model('User', new Schema({ test: mongoose.Mi***REMOVED***ed }));
 *     new User({ }).validateSync().errors.test.message; // Path `test` is required.
 *
 * @param {String} option The option you'd like to set the value for
 * @param {Any} value value for option
 * @return {undefined}
 * @function set
 * @static
 * @api public
 */

SchemaMi***REMOVED***ed.set = SchemaType.set;

SchemaMi***REMOVED***ed.setters = [];

/**
 * Casts `val` for Mi***REMOVED***ed.
 *
 * _this is a no-op_
 *
 * @param {Object} value to cast
 * @api private
 */

SchemaMi***REMOVED***ed.prototype.cast = function(val) {
  if (val instanceof Error) {
    return utils.errorToPOJO(val);
  }
  return val;
};

/**
 * Casts contents for queries.
 *
 * @param {String} $cond
 * @param {any} [val]
 * @api private
 */

SchemaMi***REMOVED***ed.prototype.castForQuery = function($cond, val) {
  return val;
};

/*!
 * Module e***REMOVED***ports.
 */

module.e***REMOVED***ports = SchemaMi***REMOVED***ed;
